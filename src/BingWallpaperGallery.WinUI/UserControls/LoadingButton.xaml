<?xml version="1.0" encoding="utf-8" ?>
<UserControl
    x:Class="BingWallpaperGallery.WinUI.UserControls.LoadingButton"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:animations="using:CommunityToolkit.WinUI.Animations"
    xmlns:behaviors="using:CommunityToolkit.WinUI.Behaviors"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i="using:Microsoft.Xaml.Interactivity"
    xmlns:local="using:BingWallpaperGallery.WinUI.UserControls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="using:CommunityToolkit.WinUI"
    mc:Ignorable="d">
    <UserControl.Resources>
        <animations:AnimationSet x:Name="RotationAnimation" IsSequential="True">
            <animations:RotationInDegreesAnimation
                EasingMode="EaseInOut"
                EasingType="Circle"
                Repeat="Forever"
                From="0"
                To="360"
                Duration="0:0:1" />
        </animations:AnimationSet>
    </UserControl.Resources>

    <Button
        Height="32"
        Margin="0,0,4,0"
        Command="{x:Bind Command}"
        Style="{ThemeResource SubtleButtonStyle}"
        ToolTipService.ToolTip="更新数据">
        <ContentPresenter
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            ui:VisualExtensions.NormalizedCenterPoint="0.5,0.5"
            Content="{ui:FontIcon FontSize=16,
                                  Glyph=&#xE895;}">
            <i:Interaction.Behaviors>
                <i:DataTriggerBehavior
                    Binding="{x:Bind Command.IsRunning, Mode=OneWay}"
                    ComparisonCondition="Equal"
                    Value="True">
                    <behaviors:StartAnimationAction Animation="{StaticResource RotationAnimation}" />
                </i:DataTriggerBehavior>
                <i:DataTriggerBehavior
                    Binding="{x:Bind Command.IsRunning, Mode=OneWay}"
                    ComparisonCondition="Equal"
                    Value="False">
                    <behaviors:StopAnimationAction Animation="{StaticResource RotationAnimation}" />
                </i:DataTriggerBehavior>
            </i:Interaction.Behaviors>
        </ContentPresenter>
    </Button>
</UserControl>
